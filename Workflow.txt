Bioimpedance LME Analysis Workflow
(Longitudinal biomarkers, robust publication-ready pipeline, 2-group design)

A. Data Preparation & Input Design
Curate long-format dataset (df_long.analysis)
Columns: USUBJID (subject ID), precise "Change_Type" group, continuous elapsed_years
Covariates: AGE, SEX, EDUYR
All bioimpedance/segmental measures: bia_vars
Quality control: remove outliers, incomplete time series
B. Exploratory Visualizations
Spaghetti plots for each BIA marker
Visualize individual/group trajectories using ggplot (geom_line, geom_smooth)
Interpret between/within subject heterogeneity

C. Longitudinal Mixed Effects Modeling (LME)
For each marker:
Fit model:marker ~ elapsed_years * Change_Type + AGE + SEX + EDUYR + (1 + elapsed_years | USUBJID)
Use lmerTest::lmer() for fits
lapply() for batch over bia_vars
Store fit objects and summaries for downstream reporting

D. Model Reporting & Visualization—Per Variable
Trajectory Visualization
Use plot_lmer_model_with_interaction_p and plot_lmer_interaction_with_p
plot_lmer_model_with_interaction_p: displays group trajectories, Wald test p-values
plot_lmer_interaction_with_p: displays full/reduced model comparison with LRT p-value for interaction
Slope Extraction & Comparison
Use analyze_longitudinal_trends to extract annual slopes, SEs, Wald p-values, Cohen’s d
Plotting Slope Differences & Significance
Use plot_slopes, plot_pvalues for marker-wise slope and significance visualization

E. Confirmatory Inference— PRIORITIZE LRT
Likelihood Ratio Test (Main)
Compare full model to reduced (no interaction term): anova(reduced, full)
Report χ², p-value for interaction term (elapsed_years × Change_Type)
Prefer LRT as main test for statistical inference due to sample size concerns
Wald Test (Secondary, Descriptive)
Extract and report Wald test p-values for each model parameter via summary(model)$coefficients
Use for descriptive interpretation
Effect Size
Calculate standardized slope difference (Cohen’s d):
(slopeCNtransitMCI−slopeStableCN)/Residual SD
Enhances clinical/biological interpretability

F. (Future/Post-hoc Expansion)
If more groups are added (e.g. "Reverted"), use emmeans for pairwise slope comparisons and multiple testing correction

G. Model Diagnostics
For each model:
Residual QQ plots, fitted vs residuals
Check random effects variance (diagnose convergence/warnings)
Summarize model statistics (AIC, BIC, marginal/conditional R²)

H. Summary Export
Tables
Annual slope by group, p-value (LRT + Wald), effect size, 95% CI, exported as .csv/.xlsx
Visual Outputs
Save spaghetti, trajectory, slope, and p-value plots for publication/self-archiving

Reference Functions (from Joel & your asset)
plot_lmer_model_with_interaction_p
For Wald test visualization
plot_lmer_interaction_with_p
For LRT (main confirmatory) visualization (recommended for publication & supplement)
analyze_longitudinal_trends
Systematic stats: slopes, SEs, p, effect size
plot_slopes, plot_pvalues
Rapid marker comparisons (highlight discriminative indices)

Batch Implementation Template
reference_group <- "StableCN"comparison_groups <- c("CNtransitMCI")results <- lapply(bia_vars, function(var) {  analyze_longitudinal_trends(    data = df_long.analysis,    response = var,    groupvar = "Change_Type",    referencegroup = reference_group,    comparisongroups = comparison_groups  )})# Main plots: LRT + Wald bothplots_LRT <- lapply(bia_vars, function(var) {  plot_lmer_interaction_with_p(df_long.analysis, response = var, groupvar = "Change_Type")})plots_Wald <- lapply(bia_vars, function(var) {  plot_lmer_model_with_interaction_p(df_long.analysis, response = var, groupvar = "Change_Type")})# Export all tables/plotsmodel_summaries <- lapply(results, function(res) res$modelsummary)bind_rows(model_summaries) %>% write.csv("Bioimpedance_LME_summary.csv", row.names = FALSE)# Save plot outputs as neededplot_slopes(model_summaries)plot_pvalues(model_summaries)

Reporting Checklist (Manuscript-ready)
Trajectory plots for each marker (Wald + LRT annotated)
Summary table: slopes, p-values (LRT highlighted, Wald reported), effect sizes
Significance testing: LRT as primary for interaction
Diagnostics: residual plots, assumption checks
Export: all tables and plots for publication/supplementary

Key Principle
LRT = test chính cho hiệu ứng tương tác (time × group)
Wald = bổ sung, kiểm định từng hệ số
Giúp tăng độ tin cậy, đặc biệt khi số mẫu nhóm nhỏ, như nghiên cứu của bạn

Áp dụng tài sản mã nguồn, workflow này sẽ giúp bạn báo cáo kết quả chính xác và chuyên nghiệp, ưu tiên LRT nhưng vẫn minh bạch về phân tích Wald.